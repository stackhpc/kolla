---
- project:
    queue: kolla

- nodeset:
    name: kolla-centos-9-stream
    nodes:
      - name: primary
        label: centos-9-stream

- nodeset:
    name: kolla-rockylinux-9
    nodes:
      - name: primary
        label: rockylinux-9

- nodeset:
    name: kolla-ubuntu-focal
    nodes:
      - name: primary
        label: ubuntu-focal

- nodeset:
    name: kolla-debian-bullseye
    nodes:
      - name: primary
        label: debian-bullseye

- nodeset:
    name: kolla-centos-9-stream-aarch64
    nodes:
      - name: primary
        label: centos-9-stream-arm64

- nodeset:
    name: kolla-debian-bullseye-aarch64
    nodes:
      - name: primary
        label: debian-bullseye-arm64

- nodeset:
    name: kolla-rockylinux-9-aarch64
    nodes:
      - name: primary
        label: rockylinux-9-arm64

- nodeset:
    name: kolla-ubuntu-focal-aarch64
    nodes:
      - name: primary
        label: ubuntu-focal-arm64

- job:
    name: kolla-base
    parent: base
    timeout: 10800
    post-timeout: 10800
    pre-run: tests/playbooks/pre.yml
    run: tests/playbooks/run.yml
    post-run: tests/playbooks/post.yml
    attempts: 5
    irrelevant-files:
      - ^.*\.rst$
      - ^doc/.*
      - ^etc/.*
      - ^releasenotes/.*$
      - ^specs/.*$
      - ^test-requirements.txt$
      - ^\.zuul\.d/
      - ^\..+
      - ^contrib/
      - ^LICENSE$
      - ^tox\.ini$
    vars:
      publisher: false
    extra-vars:
      kolla_logs_dir: "{{ zuul_output_dir }}/logs/kolla"
      kolla_build_logs_dir: "{{ kolla_logs_dir }}/build"
      virtualenv_path: "/tmp/kolla-virtualenv"

- job:
    name: kolla-build-no-infra-wheels-base
    parent: kolla-base
    vars:
      use_infra_wheels_mirror: false
